[{"appcode":"function OnUpdate(doc, meta, xattrs) {\n    log(\"Doc created/updated\", meta.id);\n    refreshCache(doc);\n}\n\nfunction OnDelete(meta, options) {\n    log(\"Doc deleted/expired\", meta.id);\n}\n\nfunction refreshCache(doc) {\n    const _class = 'com.fet.venus.db.models.LatestCacheRevamp';\n    const buffer_type = doc.bufferType;\n\n    if ( doc._class != _class ) {\n        return;\n    }\n\n    const query =\n        'SELECT revamp.* ' +\n        'FROM `vod`.`friday`.`venus_latest_cache_revamp` revamp ' +\n        'WHERE _class = $1 AND bufferType = $2 ' +\n        'ORDER BY revamp.`orderId` ASC';\n\n    const results = N1QL(query, [_class, buffer_type], { isPrepared: true });\n\n    const cache_array = []\n    for (var item of results) {   // Stream results using 'for' iterator.\n        cache_array.push(item)\n    }\n    results.close();\n\n    const cache_key = `latest_revamp::${buffer_type}`\n    cache_bucket[cache_key] = cache_array\n}","depcfg":{"buckets":[{"alias":"cache_bucket","bucket_name":"vod","scope_name":"cache","collection_name":"data","access":"rw"}],"source_bucket":"vod","source_scope":"friday","source_collection":"venus_latest_cache_revamp","metadata_bucket":"vod","metadata_scope":"eventing","metadata_collection":"venus_latest_cache_revamp"},"version":"evt-7.6.3-4200-ee","enforce_schema":false,"handleruuid":3386948613,"function_instance_id":"EKaaZ2","appname":"latest_cache_event","settings":{"cursor_aware":false,"dcp_stream_boundary":"from_now","deployment_status":false,"description":"","execution_timeout":60,"language_compatibility":"7.2.0","log_level":"INFO","n1ql_consistency":"none","num_timer_partitions":128,"processing_status":false,"timer_context_size":1024,"user_prefix":"eventing","worker_count":1},"function_scope":{"bucket":"vod","scope":"friday"}}]